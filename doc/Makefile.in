# doc/Makefile.in	-*- Makefile -*-
# $Id$
@MCOMMON@

srcdir =	@srcdir@
VPATH =		@srcdir@
.PATH:		@srcdir@

basedir = ..
thisdir = doc

first_rule: all
dummy:

DIST_ETC  = etc/rxvt.termcap etc/rxvt.terminfo etc/XTerm.ad
DIST_POD  = rxvt.1.pod rxvt.7.pod
DIST_MENU = menu/menu menu/example.menu menu/rxvt.menu menu/rxvt.zh-menu\
	    menu/terminal.menu menu/jedmenu.sl
DIST	  = Makefile.in README.menu README.xvt BUGS FAQ TODO\
	    changes.txt xterm.seq LSM.in \
	    rxvt.1.man rxvt.7.man rxvt.1.html rxvt.7.html rxvt.1.txt rxvt.7.txt

#-------------------------------------------------------------------------

all:

SEDREPLACE = -e 's%@@RXVT_VERSION@@%$(VERSION)%g;'\
	     -e 's%@@RXVT_LSMDATE@@%$(LSMDATE)%g;'\
	     -e 's%@@RXVT_NAME@@%$(RXVTNAME)%g;'\
	     -e 's%@@RXVT_DATE@@%$(DATE)%g;'\
	     -e 's%@@RXVT_MAINTEMAIL@@%$(MAINTEMAIL)%g;'\
	     -e 's%@@RXVT_MAINT@@%$(MAINT)%g;'\
	     -e 's%@@RXVT_WEBPAGE@@%$(WEBPAGE)%g;'\
	     -e 's%@@RXVT_WEBMAINTEMAIL@@%$(WEBMAINTEMAIL)%g;'\
	     -e 's%@@RXVT_WEBMAINT@@%$(WEBMAINT)%g;'

%.tbl: %.pod
	./podtbl <$< >$@

%.1.man.in: %.1.tbl
	pod2man -n rxvt -r"$(VERSION)" -q\" -s1 -c "RXVT-UNICODE" <$< >$@

%.7.man.in: %.7.tbl
	pod2man -n rxvt -r"$(VERSION)" -q\" -s7 -c "RXVT-UNICODE" <$< >$@

%.html: %.tbl
	$(SED) $(SEDREPLACE) <$< | pod2html >$@

%.txt: %.tbl
	$(SED) $(SEDREPLACE) <$< | pod2text >$@

../README.configure: rxvt.7.tbl
	$(SED) $(SEDREPLACE) <$< | podselect -section "CONFIGURE OPTIONS" | pod2text >$@

../README.FAQ: rxvt.7.tbl
	$(SED) $(SEDREPLACE) <$< | podselect -section "FREQUENTLY ASKED QUESTIONS" | pod2text >$@

tags allbin:

alldoc:	$(basedir)/$(VERNAME).lsm rxvt.1.man.in rxvt.7.man.in rxvt.1.html rxvt.7.html rxvt.1.txt rxvt.7.txt ../README.configure ../README.FAQ

$(basedir)/$(VERNAME).lsm: LSM.in $(srcdir)/../autoconf/Make.common.in
	$(SED) $(SEDREPLACE) < $(srcdir)/LSM.in > $@

clean:
	$(RMF) *~

realclean: clean
	$(RMF) tags rxvt.1.man.in rxvt.7.man.in rxvt.1.html rxvt.7.html rxvt.1.txt rxvt.7.txt  ../README.configure ../README.FAQ

cleandir: realclean

distclean:

install:
	$(INSTALL) -d $(DESTDIR)$(man1dir)
	$(INSTALL) -d $(DESTDIR)$(man7dir)
	$(SED) $(SEDREPLACE) < rxvt.1.man.in >rxvt.1.man
	$(INSTALL_DATA) rxvt.1.man $(DESTDIR)$(man1dir)/$(RXVTNAME).$(man1ext)
	$(SED) $(SEDREPLACE) < rxvt.7.man.in >rxvt.7.man
	$(INSTALL_DATA) rxvt.7.man $(DESTDIR)$(man7dir)/$(RXVTNAME).$(man7ext)
	$(INSTALL_DATA) rxvtc.1 $(DESTDIR)$(man1dir)/$(RXVTNAME)c.$(man1ext)
	$(INSTALL_DATA) rxvtc.1 $(DESTDIR)$(man1dir)/$(RXVTNAME)d.$(man1ext)
	if test -x "@TIC@"; then if test -n "@TIC@"; then @TIC@ etc/rxvt-unicode.terminfo; fi; fi

uninstall:
	-(cd $(mandir); $(RMF) $(RXVTNAME).$(manext) )

distdepend: alldoc

# ------------------------------------------------------------------------
# DO NOT DELETE: ugly dependency list follows
