@MCOMMON@

LINT = lint -DNARROWPROTO=1 $(XINC) -chapbxz

srcdir =	@srcdir@
VPATH =		@srcdir@
.PATH:		@srcdir@

top_builddir = ..
basedir = ..
thisdir = src
MKDIR = @top_srcdir@/autoconf/mkinstalldirs

# for developers: the following debug options may be used
#	-DDEBUG_CMD -DDEBUG_MAIN -DDEBUG_MENU -DDEBUG_MENUARROWS
#	-DDEBUG_MENUBAR_STACKING -DDEBUG_MENU_LAYOUT -DDEBUG_RESOURCES
#	-DDEBUG_SEARCH_PATH -DDEBUG_SIZE -DDEBUG_TTY -DDEBUG_TTYMODE
#	-DDEBUG_KEYBOARD
DEBUG=-DDEBUG_STRICT @DEBUG@

first_rule: all
dummy:

COMMON = \
	command.o rxvtfont.o init.o logging.o \
	main.o menubar.o misc.o netdisp.o ptytty.o screen.o \
	scrollbar.o scrollbar-next.o scrollbar-rxvt.o scrollbar-xterm.o scrollbar-plain.o \
	strings.o xdefaults.o xpm.o encoding.o rxvttoolkit.o rxvtutil.o iom.o keyboard.o

RXVT_BASENAME=`$(ECHO) $(RXVTNAME)|$(SED) 's/$(EXEEXT)$$//'|$(SED) '$(transform)'`
RXVT_BINNAME=$(DESTDIR)$(bindir)/$(RXVT_BASENAME)$(EXEEXT)
RXVTC_BINNAME=$(DESTDIR)$(bindir)/$(RXVT_BASENAME)c$(EXEEXT)
RXVTD_BINNAME=$(DESTDIR)$(bindir)/$(RXVT_BASENAME)d$(EXEEXT)
RXVT_OLDNAME=$(DESTDIR)$(bindir)/$(RXVT_BASENAME)-old$(EXEEXT)

#
# Distribution variables
#

.SUFFIXES:	.C .o

#-------------------------------------------------------------------------
# inference rules
.C.o:
	$(COMPILE) -c $<

#.C.lo:
#	$(LIBTOOL) --mode=compile $(COMPILE) -c $<
#
#.s.lo:
#	$(LIBTOOL) --mode=compile $(COMPILE) -c $<
#
#.S.lo:
#	$(LIBTOOL) --mode=compile $(COMPILE) -c $<

#-------------------------------------------------------------------------

all: allbin

rxvt: rxvt.o $(COMMON)
	$(LINK) -o $@ $^ $(LIBS) $(XLIB) $(DLIB)
#	$(LIBTOOL) --mode=link $(LINK) rxvt.o librxvt.la $(LIBS) $(XLIB) $(DLIB) -o $@

rxvtd: rxvtd.o rxvtdaemon.o $(COMMON)
	$(LINK) -o $@ $^ $(LIBS) $(XLIB) $(DLIB)
#	$(LIBTOOL) --mode=link $(LINK) rxvtd.o rxvtdaemon.o librxvt.la $(LIBS) $(XLIB) $(DLIB) -o $@

rxvtc: rxvtc.o rxvtdaemon.o
	$(LINK) -o $@ $^ $(LIBS) $(DLIB)
#	$(LIBTOOL) --mode=link $(LINK) rxvtc.o rxvtdaemon.o $(LIBS) $(DLIB) -o $@

#librxvt.la: $(LIBOBJS)
#	$(LIBTOOL) --mode=link $(LINK) -rpath $(libdir) -version-info $(LIBVERSION) $(LIBOBJS) $(LIBS) -o $@

#-------------------------------------------------------------------------

tags:
	ctags *.h *.C

allbin: rxvt rxvtd rxvtc

alldoc:

clean:
	$(RMF) rxvt rxvtc rxvtd core a.out *.o *.lo *.bak *~ *.intpro .libs/* librxvt.la tmpproto *.tmp

realclean: clean
	$(RMF) tags librxvt.h

cleandir: realclean

distclean: realclean
	(cd $(srcdir); $(RMF) Makefile)

install: allbin alldoc
	$(MKDIR) $(DESTDIR)$(bindir)
	$(RMF) $(RXVT_BINNAME)
	$(RMF) $(RXVTC_BINNAME)
	$(RMF) $(RXVTD_BINNAME)
	$(INSTALL_PROGRAM) rxvt  $(RXVT_BINNAME)
	$(INSTALL_PROGRAM) rxvtc $(RXVTC_BINNAME)
	$(INSTALL_PROGRAM) rxvtd $(RXVTD_BINNAME)

depend:
	makedepend -f Makefile.in -I. -Y *.C >/dev/null 2>&1
	makedepend -f Makefile.in -I. -Y *.C -a -o .lo >/dev/null 2>&1

# DO NOT DELETE: nice dependency list follows

command.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
command.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
command.o: salloc.h menubar.h version.h command.h keyboard.h
encoding.o: ../config.h encoding.h table/iso8859_1.h table/iso8859_15.h
encoding.o: table/iso8859_2.h table/iso8859_3.h table/iso8859_4.h
encoding.o: table/iso8859_5.h table/iso8859_6.h table/iso8859_7.h
encoding.o: table/iso8859_8.h table/iso8859_9.h table/iso8859_10.h
encoding.o: table/iso8859_11.h table/iso8859_13.h table/iso8859_14.h
encoding.o: table/iso8859_16.h table/koi8_r.h table/koi8_u.h
encoding.o: table/ksc5601_1987_0.h table/big5.h table/gbk_0.h
encoding.o: table/gb2312_1980_0.h table/cns11643_1992_1.h
encoding.o: table/cns11643_1992_2.h table/cns11643_1992_3.h
encoding.o: table/cns11643_1992_4.h table/cns11643_1992_5.h
encoding.o: table/cns11643_1992_6.h table/cns11643_1992_7.h
encoding.o: table/cns11643_1992_f.h table/big5_ext.h table/big5_plus.h
encoding.o: table/viscii.h table/jis0201_1976_0.h table/jis0208_1990_0.h
encoding.o: table/jis0212_1990_0.h table/jis0213_1.h table/jis0213_2.h
encoding.o: table/compose.h table/category.h
init.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h rxvtfont.h
init.o: rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h salloc.h
init.o: menubar.h init.h
iom.o: iom.h iom_conf.h rxvtutil.h callback.h
keyboard.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
keyboard.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
keyboard.o: salloc.h menubar.h keyboard.h command.h
logging.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
logging.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
logging.o: salloc.h menubar.h logging.h
main.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h rxvtfont.h
main.o: rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h salloc.h
main.o: menubar.h keyboard.h
menubar.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
menubar.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
menubar.o: salloc.h menubar.h version.h
misc.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h rxvtfont.h
misc.o: rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h salloc.h
misc.o: menubar.h
netdisp.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
netdisp.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
netdisp.o: salloc.h menubar.h
ptytty.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
ptytty.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
ptytty.o: salloc.h menubar.h
rxvt.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h rxvtfont.h
rxvt.o: rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h salloc.h
rxvt.o: menubar.h
rxvtc.o: ../config.h rxvtdaemon.h rxvtutil.h rxvt.h rxvtlib.h ptytty.h
rxvtc.o: feature.h encoding.h rxvtfont.h rxvttoolkit.h iom.h iom_conf.h
rxvtc.o: callback.h salloc.h menubar.h
rxvtd.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvtd.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
rxvtd.o: salloc.h menubar.h rxvtdaemon.h
rxvtdaemon.o: rxvtdaemon.h rxvtutil.h
rxvtfont.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvtfont.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
rxvtfont.o: salloc.h menubar.h table/linedraw.h
rxvttoolkit.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvttoolkit.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
rxvttoolkit.o: callback.h salloc.h menubar.h
rxvtutil.o: rxvtutil.h
salloc.o: salloc.h
screen.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
screen.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
screen.o: salloc.h menubar.h salloc.C
scrollbar-next.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar-next.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
scrollbar-next.o: callback.h salloc.h menubar.h
scrollbar-plain.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar-plain.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
scrollbar-plain.o: callback.h salloc.h menubar.h
scrollbar-rxvt.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar-rxvt.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
scrollbar-rxvt.o: callback.h salloc.h menubar.h
scrollbar-xterm.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar-xterm.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
scrollbar-xterm.o: callback.h salloc.h menubar.h
scrollbar.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
scrollbar.o: salloc.h menubar.h
strings.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
strings.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
strings.o: salloc.h menubar.h
xdefaults.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
xdefaults.o: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
xdefaults.o: salloc.h menubar.h version.h keyboard.h
xpm.o: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h rxvtfont.h
xpm.o: rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h salloc.h
xpm.o: menubar.h

command.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
command.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
command.lo: salloc.h menubar.h version.h command.h keyboard.h
encoding.lo: ../config.h encoding.h table/iso8859_1.h table/iso8859_15.h
encoding.lo: table/iso8859_2.h table/iso8859_3.h table/iso8859_4.h
encoding.lo: table/iso8859_5.h table/iso8859_6.h table/iso8859_7.h
encoding.lo: table/iso8859_8.h table/iso8859_9.h table/iso8859_10.h
encoding.lo: table/iso8859_11.h table/iso8859_13.h table/iso8859_14.h
encoding.lo: table/iso8859_16.h table/koi8_r.h table/koi8_u.h
encoding.lo: table/ksc5601_1987_0.h table/big5.h table/gbk_0.h
encoding.lo: table/gb2312_1980_0.h table/cns11643_1992_1.h
encoding.lo: table/cns11643_1992_2.h table/cns11643_1992_3.h
encoding.lo: table/cns11643_1992_4.h table/cns11643_1992_5.h
encoding.lo: table/cns11643_1992_6.h table/cns11643_1992_7.h
encoding.lo: table/cns11643_1992_f.h table/big5_ext.h table/big5_plus.h
encoding.lo: table/viscii.h table/jis0201_1976_0.h table/jis0208_1990_0.h
encoding.lo: table/jis0212_1990_0.h table/jis0213_1.h table/jis0213_2.h
encoding.lo: table/compose.h table/category.h
init.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
init.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
init.lo: salloc.h menubar.h init.h
iom.lo: iom.h iom_conf.h rxvtutil.h callback.h
keyboard.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
keyboard.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
keyboard.lo: salloc.h menubar.h keyboard.h command.h
logging.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
logging.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
logging.lo: salloc.h menubar.h logging.h
main.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
main.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
main.lo: salloc.h menubar.h keyboard.h
menubar.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
menubar.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
menubar.lo: salloc.h menubar.h version.h
misc.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
misc.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
misc.lo: salloc.h menubar.h
netdisp.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
netdisp.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
netdisp.lo: salloc.h menubar.h
ptytty.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
ptytty.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
ptytty.lo: salloc.h menubar.h
rxvt.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvt.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
rxvt.lo: salloc.h menubar.h
rxvtc.lo: ../config.h rxvtdaemon.h rxvtutil.h rxvt.h rxvtlib.h ptytty.h
rxvtc.lo: feature.h encoding.h rxvtfont.h rxvttoolkit.h iom.h iom_conf.h
rxvtc.lo: callback.h salloc.h menubar.h
rxvtd.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvtd.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
rxvtd.lo: salloc.h menubar.h rxvtdaemon.h
rxvtdaemon.lo: rxvtdaemon.h rxvtutil.h
rxvtfont.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvtfont.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
rxvtfont.lo: salloc.h menubar.h table/linedraw.h
rxvttoolkit.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
rxvttoolkit.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
rxvttoolkit.lo: callback.h salloc.h menubar.h
rxvtutil.lo: rxvtutil.h
salloc.lo: salloc.h
screen.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
screen.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
screen.lo: salloc.h menubar.h salloc.C
scrollbar-next.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar-next.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
scrollbar-next.lo: callback.h salloc.h menubar.h
scrollbar-plain.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h
scrollbar-plain.lo: encoding.h rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h
scrollbar-plain.lo: iom_conf.h callback.h salloc.h menubar.h
scrollbar-rxvt.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar-rxvt.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h
scrollbar-rxvt.lo: callback.h salloc.h menubar.h
scrollbar-xterm.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h
scrollbar-xterm.lo: encoding.h rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h
scrollbar-xterm.lo: iom_conf.h callback.h salloc.h menubar.h
scrollbar.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
scrollbar.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
scrollbar.lo: salloc.h menubar.h
strings.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
strings.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
strings.lo: salloc.h menubar.h
xdefaults.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h
xdefaults.lo: rxvtfont.h rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h
xdefaults.lo: salloc.h menubar.h version.h keyboard.h
xpm.lo: ../config.h rxvt.h rxvtlib.h ptytty.h feature.h encoding.h rxvtfont.h
xpm.lo: rxvtutil.h rxvttoolkit.h iom.h iom_conf.h callback.h salloc.h
xpm.lo: menubar.h
